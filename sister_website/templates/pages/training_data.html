{% extends "base.html" %}

{% block title %}Submit Training Data{% endblock %}

{% block content %}
<section class="training-section">
    <h2>Contribute Build Screenshots</h2>
    <p class="lead">Help us build SISTER's first neural network. Your STO build screenshots will train a CNN for label detection, enabling SISTER to run as a fast web API without GPU requirements.</p>

    <div class="github-info">
        <p>SISTER is an open-source project. <a href="https://github.com/phillipod/SISTER" target="_blank" rel="noopener noreferrer">View on GitHub</a> | 
        <a href="https://github.com/phillipod/SISTER/releases/tag/v2025.05.31-release" target="_blank" rel="noopener noreferrer">Current release: v2025.05.31</a> | 
        <a href="{{ url_for('training_data_stats') }}" class="stats-link">Submission Statistics</a></p>
    </div>

    <div class="training-overview">
        <div class="training-goal">
            <h3>The Goal</h3>
            <p>We're building a custom CNN to replace EasyOCR, enabling SISTER to run as a web API without GPU acceleration. Your screenshots provide the training data we need.</p>
        </div>
        
        <div class="account-options">
            <h3>Submit With or Without an Account</h3>
            <p><strong>No account:</strong> Just use your email - you'll get confirmations via email.</p>
            <p><strong>With account:</strong> Track submissions, auto-filled forms, manage your contribution history.</p>
        </div>
    </div>

    <div class="screenshot-requirements">
        <h3>Screenshot Requirements</h3>
        <p>For the best training data, please ensure your screenshots are:</p>
        <ul>
            <li>Full resolution, unmodified originals</li>
            <li>Clear UI elements without overlapping windows or tooltips</li>
            <li>Complete build information for space and/or ground</li>
        </ul>
    </div>

    <div class="process-flow">
        <h3>How It Works</h3>
        <ol>
            <li>Upload your build screenshots</li>
            <li>Agree to the CC BY-NC-SA 4.0 license terms</li>
            <li>Receive email confirmation</li>
            <li>Reply to confirm participation</li>
        </ol>
    </div>

    <div class="screenshot-guide">
        <div class="tip">ðŸ’¡ You can submit multiple builds at once using the "Add Another Build" button below.</div>
    </div>

    <form action="{{ url_for('training_data_submit') }}" method="post" enctype="multipart/form-data" class="upload-form" id="uploadForm">
        {{ form.csrf_token }}
        
        <div class="form-section">
            <h3>Contact Information</h3>
            <div class="form-group">
                {{ form.email.label }}
                <div class="input-help">Your email is required for consent confirmation and will not be shared publicly.
                    {% if current_user.is_authenticated %}
                        <br><span style="color: #28a745; font-size: 0.9em;"><i class="fas fa-check-circle"></i> Auto-filled from your account</span>
                    {% endif %}
                </div>
                {{ form.email(class="form-control", placeholder="your.email@example.com") }}
                {% if form.email.errors %}
                    <div class="errors">
                        {% for error in form.email.errors %}
                            <span class="error">{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="form-section">
            <h3>License Agreement</h3>
            <p class="consent-intro">To contribute your screenshots, you must agree to license them under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0) license. This license allows the SISTER project to use your contributions for specific purposes while ensuring they remain freely available under similar terms.</p>
            <div class="consent-group">
                <div class="consent-option">
                    {{ form.agree_to_license(class="consent-checkbox") }}
                    <label class="consent-label" for="agree_to_license">{{ form.agree_to_license.label.text }} <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">(Learn more about CC BY-NC-SA 4.0)</a></label>
                    {% if form.agree_to_license.errors %}
                        <div class="errors">
                            {% for error in form.agree_to_license.errors %}
                                <span class="error">{{ error }}</span>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
                <p class="consent-details">Specifically, your agreement allows us to use your screenshots for:</p>
                <ul>
                    <li>Training machine learning models for recognizing elements in Star Trek Online screenshots.</li>
                    <li>Future machine learning research and development related to STO build analysis.</li>
                    <li>Inclusion in the SISTER project's test suite to ensure software quality.</li>
                </ul>
                <p>The CC BY-NC-SA 4.0 license is irrevocable for data that has been shared or distributed. This means that once your data is part of a dataset released under this license, the license terms for that data cannot be revoked.</p>
            </div>
        </div>

        <div id="buildsContainer">
            <div class="build-section" data-build-index="0">
                <div class="build-header">
                    <h3>Build Screenshots</h3>
                </div>
                <div class="screenshots-section">
                    <div class="build-platform-selection">
                        <h4>Build Platform</h4>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="build_platform_0" value="PC" checked>
                                PC
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="build_platform_0" value="Console">
                                Console
                            </label>
                        </div>
                    </div>
                    <div class="build-type-selection">
                        <h4>Build Type</h4>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="build_type_0" value="space" checked>
                                Space Build
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="build_type_0" value="ground">
                                Ground Build
                            </label>
                        </div>
                    </div>
                    <div class="file-upload-section">
                        <h4>Screenshots</h4>
                        <input type="file" name="screenshots_0" multiple class="file-input">
                    </div>
                </div>
            </div>
        </div>

        <button type="button" id="addBuildBtn" class="add-build-btn">
            Add Another Build
        </button>

        <div class="form-actions">
            <button type="submit" id="submitBtn" class="submit-btn" style="min-width: 180px; display: inline-flex; align-items: center; justify-content: center;">
                <span class="spinner"></span>
                <span class="button-text">Submit Screenshots</span>
            </button>
        </div>
    </form>

    <div class="privacy-section">
        <h3>Privacy &amp; Licensing</h3>
        <div class="privacy-summary">
            <p>By submitting screenshots, you license them under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">CC BY-NC-SA 4.0</a> for training our label detection CNN and related research.</p>
        </div>
        
        <details class="privacy-details">
            <summary>Full Privacy &amp; Licensing Details</summary>
            <ul>
                <li><strong>Storage:</strong> Screenshots are stored in public GitHub repositories under the CC BY-NC-SA 4.0 license.</li>
                <li><strong>Uses:</strong> Training the label detection CNN, computer vision research, and test suite quality assurance.</li>
                <li><strong>Email:</strong> Used only for consent confirmation, never published or shared.</li>
                <li><strong>Withdrawal:</strong> You can request exclusion from future datasets. Previously published copies remain under the existing license.</li>
                <li><strong>Permanence:</strong> The CC BY-NC-SA 4.0 license is irrevocable once distributed, ensuring dataset stability.</li>
                <li><strong>Scope:</strong> Usage strictly limited to improving STO build analysis tools and related computer vision research.</li>
            </ul>
            <p>After submission, you'll receive an email to verify your consent before any data processing begins.</p>
        </details>
    </div>
</section>

<script src="{{ url_for('static', filename='js/training_data.js') }}"></script>
{% endblock %} 
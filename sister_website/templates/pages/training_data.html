{% extends "base.html" %}

{% block title %}Submit Training Data{% endblock %}

{% block content %}
<section class="training-section">
    <h2>Build Screenshot Collection</h2>
    <p class="lead">Help improve SISTER by contributing your Star Trek Online build screenshots for training.</p>

    <div class="github-info">
        <p>SISTER is an open-source project. Visit our <a href="https://github.com/phillipod/SISTER" target="_blank" rel="noopener noreferrer">GitHub repository</a> to learn more about the project, download the latest release, or contribute.</p>
        <p>Current release: <a href="https://github.com/phillipod/SISTER/releases/tag/v2025.05.31-release" target="_blank" rel="noopener noreferrer">v2025.05.31</a> | 
        <a href="{{ url_for('training_data_stats') }}" class="stats-link">View Submission Statistics</a></p>
    </div>

    <h3>How It Works</h3>
    <ol>
        <li>Upload screenshots for your builds (space and/or ground)</li>
        <li>Provide your email address</li>
        <li>Review and agree to the CC BY-NC-SA 4.0 license terms for your submission</li>
        <li>Receive a detailed consent form via email</li>
        <li>Reply to confirm your consent</li>
    </ol>

    <div class="screenshot-guide">
        <h3>Screenshot Guidelines</h3>
        <ul>
            <li>Take screenshots at full resolution (no downscaling)</li>
            <li>Ensure all UI elements are clearly visible</li>
            <li>Avoid overlapping windows or tooltips</li>
            <li>Include both space and ground builds if possible</li>
            <li>Multiple screenshots per build are allowed</li>
        </ul>
        <div class="tip">ðŸ’¡ Tip: You can add multiple builds using the "Add Another Build" button below.</div>
    </div>

    <form action="{{ url_for('training_data_submit') }}" method="post" enctype="multipart/form-data" class="upload-form" id="uploadForm">
        {{ form.csrf_token }}
        
        <div class="form-section">
            <h3>Contact Information</h3>
            <div class="form-group">
                {{ form.email.label }}
                <div class="input-help">Your email is required for consent confirmation and will not be shared publicly.
                    {% if current_user.is_authenticated %}
                        <br><span style="color: #28a745; font-size: 0.9em;"><i class="fas fa-check-circle"></i> Auto-filled from your account</span>
                    {% endif %}
                </div>
                {{ form.email(class="form-control", placeholder="your.email@example.com") }}
                {% if form.email.errors %}
                    <div class="errors">
                        {% for error in form.email.errors %}
                            <span class="error">{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="form-section">
            <h3>License Agreement</h3>
            <p class="consent-intro">To contribute your screenshots, you must agree to license them under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0) license. This license allows the SISTER project to use your contributions for specific purposes while ensuring they remain freely available under similar terms.</p>
            <div class="consent-group">
                <div class="consent-option">
                    {{ form.agree_to_license(class="consent-checkbox") }}
                    <label class="consent-label" for="agree_to_license">{{ form.agree_to_license.label.text }} <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">(Learn more about CC BY-NC-SA 4.0)</a></label>
                    {% if form.agree_to_license.errors %}
                        <div class="errors">
                            {% for error in form.agree_to_license.errors %}
                                <span class="error">{{ error }}</span>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
                <p class="consent-details">Specifically, your agreement allows us to use your screenshots for:</p>
                <ul>
                    <li>Training machine learning models for recognizing elements in Star Trek Online screenshots.</li>
                    <li>Future machine learning research and development related to STO build analysis.</li>
                    <li>Inclusion in the SISTER project's test suite to ensure software quality.</li>
                </ul>
                <p>The CC BY-NC-SA 4.0 license is irrevocable for data that has been shared or distributed. This means that once your data is part of a dataset released under this license, the license terms for that data cannot be revoked.</p>
            </div>
        </div>

        <div id="buildsContainer">
            <div class="build-section" data-build-index="0">
                <div class="build-header">
                    <h3>Build Screenshots</h3>
                </div>
                <div class="screenshots-section">
                    <div class="build-platform-selection">
                        <h4>Build Platform</h4>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="build_platform_0" value="PC" checked>
                                PC
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="build_platform_0" value="Console">
                                Console
                            </label>
                        </div>
                    </div>
                    <div class="build-type-selection">
                        <h4>Build Type</h4>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="build_type_0" value="space" checked>
                                Space Build
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="build_type_0" value="ground">
                                Ground Build
                            </label>
                        </div>
                    </div>
                    <div class="file-upload-section">
                        <h4>Screenshots</h4>
                        <input type="file" name="screenshots_0" multiple class="file-input">
                    </div>
                </div>
            </div>
        </div>

        <button type="button" id="addBuildBtn" class="add-build-btn">
            Add Another Build
        </button>

        <div class="form-actions">
            <button type="submit" id="submitBtn" class="submit-btn" style="min-width: 180px; display: inline-flex; align-items: center; justify-content: center;">
                <span class="spinner"></span>
                <span class="button-text">Submit Screenshots</span>
            </button>
        </div>
    </form>

    <div class="privacy-section">
        <h3>License, Privacy &amp; Data Usage</h3>
        <p>Your contributions are valuable to the SISTER project. Here's how we handle your data and licensing:</p>
        <ul>
            <li><strong>Licensing:</strong> By submitting screenshots, you agree to license them under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0) license</a>. This means your contributions can be used, shared, and adapted by the SISTER project and others, provided they adhere to the terms of this license (attribution, non-commercial use, and share-alike).</li>
            <li><strong>Permitted Uses:</strong> As per the license agreement, your screenshots will be used for training machine learning models, future machine learning research, and inclusion in our test suite.</li>
            <li><strong>Public Availability:</strong> Screenshots and derived data may be published in public GitHub repositories or other accessible forms as part of open research and open data efforts, consistent with the CC BY-NC-SA 4.0 license.</li>
            <li><strong>Irrevocability:</strong> The CC BY-NC-SA 4.0 license is irrevocable. This means that once your data is distributed under this license, the permissions you've granted cannot be withdrawn for those copies. This is standard for Creative Commons licenses to ensure stability for downstream users.</li>
            <li><strong>Withdrawal:</strong> You may request that we stop using your screenshots in future datasets or training runs. Copies that have already been published will remain available under the CC BY-NC-SA 4.0 license.</li>
            <li><strong>Email Usage:</strong> Your email address is collected solely for the purpose of sending you a confirmation and consent verification for your submission. It will not be published or shared with third parties.</li>
            <li><strong>Data Usage Scope:</strong> All data usage is strictly limited to activities that improve Star Trek Online build analysis tools and related research within the SISTER project.</li>
        </ul>
        <p>After submitting your screenshots and agreeing to the license, you'll receive an email to confirm your submission. Your data will be processed according to these terms upon your confirmation.</p>
    </div>
</section>

<script src="{{ url_for('static', filename='js/training_data.js') }}"></script>
{% endblock %} 